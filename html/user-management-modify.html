<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
		<meta name="description" content="">
		<meta name="author" content="">
		<meta name="keywords" content="">
		<!-- Favicon -->
		<link rel="icon" href="" type="image/x-icon"/>
		<!-- Title -->
		<title>상암월드컵경기장</title>
		<!-- Bootstrap css-->
		<link href="../assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
		<!-- Icons css-->
		<link href="../assets/plugins/web-fonts/icons.css" rel="stylesheet"/>
		<link href="../assets/plugins/web-fonts/font-awesome/font-awesome.min.css" rel="stylesheet">
		<link href="../assets/plugins/web-fonts/plugin.css" rel="stylesheet"/>
		<!-- Style css-->
		<link href="../assets/css/style.css" rel="stylesheet">
		<link href="../assets/css/skins.css" rel="stylesheet">
		<!-- Sidemenu css-->
		<link href="../assets/css/sidemenu/sidemenu.css" rel="stylesheet">
		<link href="../assets/css/sangam.css" rel="stylesheet">
		<link href="../assets/css/twentytwenty.css" rel="stylesheet" type="text/css">
		<!-- Select2 css -->
		<link href="../assets/plugins/select2/css/select2.min.css" rel="stylesheet">
		<!--Bootstrap-datepicker css-->
		<link rel="stylesheet" href="../assets/plugins/bootstrap-datepicker/bootstrap-datepicker.css">
		<link href="../assets/plugins/spectrum-colorpicker/spectrum.css" rel="stylesheet">
		<!-- Internal Datetimepicker-slider css -->
		<link href="../assets/plugins/amazeui-datetimepicker/css/amazeui.datetimepicker.css" rel="stylesheet">
		<!-- Internal DataTables css-->
		<link href="../assets/plugins/datatable/dataTables.bootstrap4.min.css" rel="stylesheet" />
		<link href="../assets/plugins/datatable/responsivebootstrap4.min.css" rel="stylesheet" />
		<link href="../assets/plugins/datatable/fileexport/buttons.bootstrap4.min.css" rel="stylesheet" />
		<style>
		.add-modal-btn > button:nth-child(1) {
		    background: #ff5163;
		    color: #fff;
		}
		.add-modal-btn > button:nth-child(2) {
		    background: #3b76e1;
		    color: #fff;
		}
		</style>
	</head>

	<body class="main-body leftmenu">
		<!-- Loader -->
		<div id="global-loader">
			<img src="../assets/img/loader.svg" class="loader-img" alt="Loader">
		</div>
		<!-- End Loader -->
		<!-- Page -->
		<div class="page">
			<!-- Sidemenu -->
			<?include "../include/sidebar.php";?>
			<!-- End Sidemenu -->
			<!-- Main Header-->
			<?include "../include/header.php";?>
			<!-- End Main Header-->
			<!-- Mobile-header -->

			<!-- //Mobile-header -->
			<!-- Main Content-->
			<div class="main-content side-content pt-0">
				<div class="container-fluid main-m-pt">
					<div class="inner-body">
						<!-- Page Header -->
						<div class="page-header">
							<div>
								<h2 class="main-content-title text-white tx-24 mg-b-5 font-weight-bold">사용자관리</h2>
								<ol class="breadcrumb">
									<li class="breadcrumb-item">Home</li>
									<li class="breadcrumb-item active" aria-current="page">사용자관리</li>
								</ol>
							</div>
						</div>
						<!-- End Page Header -->
						<!--Row-->
						<div class="row row-sm mt-4">
							<!-- col -->
							<div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
								<div class="card custom-card overflow-hidden">
									<div class="card-header border-bottom-0 pb-0">
										<div>
											<div class="d-flex-sb border-bottom">
												<label class="main-content-label my-auto pt-2 pb-3 tx-16">회원 정보 수정</label>
											</div>
										</div>
									</div>
									<form action="../php/modifyUser.php" method="post" id="modifyForm" onsubmit="return modifyUser()">
									<div class="card-body">
										<div class="row row-sm">
											<div class="form-group col-md-12 mb-4">
												<div class="row row-sm">
													<div class="col-md-2">
														<label class="form-label pt-2">아이디</label>
													</div>
													<div class="col-md-10">
														<input type="text" name="userId" class="form-control" placeholder="" value="<?=$_POST['userId']?>" readonly="readonly">
													</div>
												</div>
											</div>
											<div class="form-group col-md-12 mb-4">
												<div class="row row-sm">
													<div class="col-md-2">
														<label class="form-label pt-2">비밀번호</label>
													</div>
													<div class="col-md-10">
														<input type="password" name="password" class="form-control" placeholder="변경 시 입력">
													</div>
												</div>
											</div>
											<div class="form-group col-md-12 mb-4">
												<div class="row row-sm">
													<div class="col-md-2">
														<label class="form-label pt-2">비밀번호 확인</label>
													</div>
													<div class="col-md-10">
														<input type="password" name="password2" class="form-control" placeholder="비밀번호를 다시 입력해주세요.">
													</div>
												</div>
											</div>
											<div class="form-group col-md-12 mb-4">
												<div class="row row-sm">
													<div class="col-md-2">
														<label class="form-label pt-2">담당자</label>
													</div>
													<div class="col-md-10">
														<input type="text" name="userName" class="form-control" placeholder="">
													</div>
												</div>
											</div>
											<div class="form-group col-md-12 mb-4">
												<div class="row row-sm">
													<div class="col-md-2">
														<label class="form-label pt-2">권한 설정</label>
													</div>
													<div class="col-md-10">
														<ul class="nav nav-tabs nav-tabs-solid nav-justified border-0">
															<li class="nav-item mr-4"><a href="#" class="tab-link wd-100p active" data-toggle="tab">사용자</a></li>
															<li class="nav-item"><a href="#" class="tab-link wd-100p" data-toggle="tab">관리자</a></li>
														</ul>
														<input type="hidden" name="userCode" id="userCode" value="0"/>
													</div>
												</div>
											</div>
											<div class="form-group col-md-12 mb-4">
												<div class="row row-sm">
													<div class="col-md-2">
														<label class="form-label pt-2">부서</label>
													</div>
													<div class="col-md-10">
														<select name="dept" class="form-control">
															<option value="관리">관리</option>
															<option value="행정">행정</option>
															<option value="기상">기상</option>
														</select>
													</div>
												</div>
											</div>
											<div class="form-group col-md-12">
												<div class="row row-sm">
													<div class="col-md-2">
														<label class="form-label pt-2">연락처</label>
													</div>
													<div class="col-md-10">
														<div class="row row-sm">
															<div class="col-md-4 col-4">
																<input type="text" class="form-control" name="hp1" pattern="[0-9]+"placeholder="">
															</div>
															<div class="col-md-4 col-4">
																<input type="text" class="form-control" name="hp2" pattern="[0-9]+" placeholder="">
															</div>
															<div class="col-md-4 col-4">
																<input type="text" class="form-control" name="hp3" pattern="[0-9]+" placeholder="">
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="add-modal-btn mt-3 modal-btn-border">
											<button id="deleteUser" type="button" style="margin-right: auto;">삭제</button>
											<button type="submit">수정</button>
											<button type="button" onclick="location.href='user-management.html';">취소</button>
										</div>
									</div>
									</form>
								</div>
							</div>
							<!-- col end -->
						</div>
						<!-- Row end -->
					</div>
				</div>
			</div>
			<!-- End Main Content-->
			<!-- modal content -->

			<!-- /modal content -->
			<!-- Main Footer-->
			<div class="main-footer text-center">
				<div class="container">
					<div class="row row-sm">
						<div class="col-md-12">
							<span class="text-white">Copyright © 2023 <a style="color: #80b9ed;">상암월드컵경기장</a></span>
						</div>
					</div>
				</div>
			</div>
			<!--End Footer-->
		</div>
		<!-- End Page -->

		<!-- Back-to-top -->
		<a href="#top" id="back-to-top"><i class="fe fe-arrow-up"></i></a>

		<!-- Jquery js-->
		<script src="../assets/plugins/jquery/jquery.min.js"></script>

		<!-- Bootstrap js-->
		<script src="../assets/plugins/bootstrap/js/popper.min.js"></script>
		<script src="../assets/plugins/bootstrap/js/bootstrap.min.js"></script>

		<!-- Peity js-->
		<script src="../assets/plugins/peity/jquery.peity.min.js"></script>
		<!-- Internal Jquery-Ui js-->
		<script src="../assets/plugins/jquery-ui/ui/widgets/datepicker.js"></script>
		<!-- Select2 js-->
		<script src="../assets/plugins/select2/js/select2.min.js"></script>
		<!-- Internal Chart.Bundle js-->
		<script src="../assets/plugins/chart.js/Chart.bundle.min.js"></script>
		<!-- Internal Jquery.maskedinput js-->
		<script src="../assets/plugins/jquery.maskedinput/jquery.maskedinput.js"></script>
		<!-- Sidemenu js -->
		<script src="../assets/plugins/sidemenu/sidemenu.js"></script>

		<!-- Internal Specturm-colorpicker js-->
		<script src="../assets/plugins/spectrum-colorpicker/spectrum.js"></script>
		<!-- Select2 js-->
		<script src="../assets/plugins/select2/js/select2.min.js"></script>
		<script src="../assets/js/select2.js"></script>
		<!--Bootstrap-datepicker js-->
		<script src="../assets/plugins/bootstrap-datepicker/bootstrap-datepicker.js"></script>
		<!-- Internal jquery-simple-datetimepicker js -->
		<script src="../assets/plugins/amazeui-datetimepicker/js/amazeui.datetimepicker.min.js"></script>

		<!-- Internal Data Table js -->
		<script src="../assets/plugins/datatable/jquery.dataTables.min.js"></script>
		<script src="../assets/plugins/datatable/dataTables.bootstrap4.min.js"></script>
		<script src="../assets/plugins/datatable/dataTables.responsive.min.js"></script>
		<script src="../assets/plugins/datatable/fileexport/dataTables.buttons.min.js"></script>
		<script src="../assets/plugins/datatable/fileexport/buttons.bootstrap4.min.js"></script>
		<script src="../assets/js/table-data.js"></script>
		<!-- Internal Dashboard js-->
		<script src="../assets/js/crypto-exchange.js"></script>
		<!-- Internal Form-elements js-->
		<script src="../assets/js/form-elements.js"></script>
		<!-- Sticky js -->
		<script src="../assets/js/sticky.js"></script>
		<!-- twentytwenty -->
		<script src="../assets/js/jquery.event.move.js"></script>
		<script src="../assets/js/jquery.twentytwenty.js"></script>
		<!-- Custom js -->
		<script src="../assets/js/custom.js"></script>
		<script>
			$(document).ready(function() {  
				$(".twentytwenty-container[data-orientation!='vertical']").twentytwenty({default_offset_pct: 0.5});
				$(".twentytwenty-container[data-orientation='vertical']").twentytwenty({default_offset_pct: 0.5, orientation: 'vertical'});
				$("#sensorBtn-1").click(function(){
					$("#sensorDate-1").toggle();
					$("#infoBox").toggle();
				});
				
				$("#addContact").on("click", function() {  
					$("#more-contact").append("<div class='form-group'><input type='text' class='form-control' id='' placeholder=''/></div>");  
				});  
				$("#removeContact").on("click", function() {  
					$("#more-contact").children().last().remove();  
				});  
			});  
			
			
			$('.wd-100p:eq(0)').on('click',function(){
				$('#userCode').val(0)
			})
			
			$('.wd-100p:eq(1)').on('click',function(){
				$('#userCode').val(1)
			})
			
			function checkNumber(event) {
			  if(event.key === '.' 
			     || event.key === '-'
			     || event.key >= 0 && event.key <= 9) {
			    return true;
			  }
			  
			  return false;
			}
			
			function modifyUser(){
				if(confirm("사용자 정보를 변경하시겠습니까?")){
					
					if($('#modifyForm [name="password"]').val() != '' && $('#modifyForm [name="password"]').val()!=$('#modifyForm [name="password2"]').val()){
						alert('비밀번호 확인이 일치하지 않습니다.');
						return false;
					}
					
					if($('#modifyForm [name="password"]').val() != '' && $('#modifyForm [name="password"]').val().length<4){
						alert('비밀번호는 4자리 이상 입력해주세요.');
						return false;
					}
					
					return true;
				}
				return false;
			}
			
			function userInfo(){
				$.ajax({
					url : "../php/userInfo.php",
					method : "POST",
					data : "userId=<?=$_POST['userId']?>",
					success : function(result){
						//console.log(result)
						$('#modifyForm [name="userName"]').val(result.USER_NAME)
						$('#modifyForm [name="dept"]').val(result.DEPT)
						$('#modifyForm [name="hp1"]').val(result.HP.split('-')[0])
						$('#modifyForm [name="hp2"]').val(result.HP.split('-')[1])
						$('#modifyForm [name="hp3"]').val(result.HP.split('-')[2])
						$('#modifyForm [name="userCode"]').val(result.USER_CODE)
						
						if(result.USER_CODE==0){
							$('.wd-100p:eq(0)').click();
						}else{
							$('.wd-100p:eq(1)').click();
						}
					}
				})
			}
			
			userInfo();
			
			$('#deleteUser').on('click',function(){
				
				var chk = confirm("유저를 삭제하시겠습니까?");
				
				if(!chk){
					return
				}
				
				var form = document.createElement('form');
        		var objs;
        		objs = document.createElement('input');
        		objs.setAttribute('type', 'hidden');
        		objs.setAttribute('name', 'userId');
        		objs.setAttribute('value', "<?=$_POST['userId']?>");
        		form.appendChild(objs);
        		form.setAttribute('method', 'post');
        		form.setAttribute('action', "../php/deleteUser.php");
        		
        		document.body.appendChild(form);
        		form.submit();
			})
		</script>
	</body>
</html>
